<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚ã‹ã‚Šã¦é¸æ‰‹æ¨©</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module">
        // Firebase SDK ã®èª­ã¿è¾¼ã¿
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-analytics.js";
        import {
            getDatabase,
            ref,
            onValue,
            update,
            set,
            get
        } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

        // Firebase è¨­å®š
        const firebaseConfig = {
            apiKey: "AIzaSyDVqlFnC6jk0wHPPgotSPeUvjseoBbdJso",
            authDomain: "rdgenquiz.firebaseapp.com",
            projectId: "rdgenquiz",
            storageBucket: "rdgenquiz.firebasestorage.app",
            messagingSenderId: "303759529622",
            appId: "1:303759529622:web:fcd67455991d1954b514b7",
            measurementId: "G-YFB0DZWXJ0",
            databaseURL: "https://rdgenquiz-default-rtdb.firebaseio.com"
        };

        // Firebase åˆæœŸåŒ–
        const app = initializeApp(firebaseConfig);
        getAnalytics(app);
        const db = getDatabase(app);
        const roomRef = ref(db, "game-room");

        // çŠ¶æ…‹ç®¡ç†ç”¨
        let myRole = ""; // "host" or "player1", "player2", "player3"
        let myName = ""; // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®åå‰

        // --- åå‰å…¥åŠ›å®Œäº† ---
        window.submitName = async () => {
            const nameInput = document.getElementById("name-input");
            const name = nameInput.value.trim();
            if (!name) {
                alert("åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
                return;
            }
            myName = name;
            document.getElementById("name-input-screen").classList.add("hidden");
            document.getElementById("setup").classList.remove("hidden");
        };

        // --- ã‚ãã³ã‹ãŸï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ï¼‰ ---
        window.openHowTo = () => {
            document.getElementById("howto-modal").classList.remove("hidden");
        };

        window.closeHowTo = () => {
            document.getElementById("howto-modal").classList.add("hidden");
        };

        window.handleHowToBackdrop = (e) => {
            // èƒŒæ™¯ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹
            if (e.target?.id === "howto-modal") window.closeHowTo();
        };

        // --- ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ï¼šè‡ªå‹•ä¼¸é•·ï¼ˆæŠ˜ã‚Šè¿”ã—ï¼‰ ---
        window.autoResize = (el) => {
            if (!el) return;
            el.style.height = "auto";
            el.style.height = `${el.scrollHeight}px`;
        };

        function escapeHtml(str) {
            return String(str ?? "")
                .replaceAll("&", "&amp;")
                .replaceAll("<", "&lt;")
                .replaceAll(">", "&gt;")
                .replaceAll("\"", "&quot;")
                .replaceAll("'", "&#39;");
        }

        // --- å½¹å‰²é¸æŠ ---
        window.selectRole = async (role) => {
            myRole = role;
            // Firebaseã«åå‰ã¨å½¹å‰²ã‚’ä¿å­˜
            const playersRef = ref(db, `game-room/players`);
            const snap = await get(playersRef);
            const players = snap.val() || {};
            players[role] = myName;
            await update(playersRef, players);

            document.getElementById("setup").classList.add("hidden");
            document.getElementById("game").classList.remove("hidden");
            initGame();
        };

        function initGame() {
            onValue(roomRef, (snapshot) => {
                const data = snapshot.val() || {};
                render(data);
            });
        }

        // --- ãƒ¡ã‚¤ãƒ³ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° ---
        function render(data) {
            const statusEl = document.getElementById("status");
            const questionBox = document.getElementById("question-box");
            const answersContainer = document.getElementById("answers-container");
            const hostControls = document.getElementById("host-controls");
            const roleLabel = document.getElementById("role-label");

            // å·¦ä¸Šã®ä¸è¦ãªã‚¹ã‚³ã‚¢ãƒœãƒƒã‚¯ã‚¹ã‚’éš ã™
            const scoresEl = document.getElementById("scores");
            if (scoresEl) scoresEl.style.display = "none";

            answersContainer.innerHTML = "";
            hostControls.innerHTML = "";

            const players = data.players || {};
            const points = data.points || {};
            const roleMap = {
                host: "å‡ºé¡Œè€…",
                player1: "å›ç­”è€…1",
                player2: "å›ç­”è€…2",
                player3: "å›ç­”è€…3",
            };
            const displayName = players[myRole] || roleMap[myRole] || "";
            roleLabel.innerText = myRole ? `ã‚ãªãŸï¼š${displayName}ï¼ˆ${roleMap[myRole] || ""}ï¼‰` : "";

            // 0. çµæœç™ºè¡¨ãƒ•ã‚§ãƒ¼ã‚º (ã“ã“ãŒæ¶ˆãˆã¦ã„ãŸãŸã‚å¾©å…ƒ)
            if (data.gameFinished) {
                statusEl.innerText = "ğŸ‰ æœ€çµ‚çµæœç™ºè¡¨ ğŸ‰";
                const scoreData = [
                    { id: "player1", label: players.player1 || "å›ç­”è€…1", score: points.player1 || 0 },
                    { id: "player2", label: players.player2 || "å›ç­”è€…2", score: points.player2 || 0 },
                    { id: "player3", label: players.player3 || "å›ç­”è€…3", score: points.player3 || 0 },
                ];
                scoreData.sort((a, b) => b.score - a.score);

                questionBox.innerHTML = `
                    <div class="w-full space-y-4 py-4">
                        ${scoreData.map((s, idx) => {
                            const rank = idx + 1;
                            const medal = rank === 1 ? "ğŸ¥‡" : rank === 2 ? "ğŸ¥ˆ" : rank === 3 ? "ğŸ¥‰" : "";
                            const bgColor = rank === 1 ? "from-yellow-100 to-amber-100 border-amber-400" : "from-gray-50 to-gray-100 border-gray-300";
                            return `
                                <div class="border-4 rounded-2xl bg-gradient-to-r ${bgColor} p-4 flex items-center justify-between shadow-sm">
                                    <div class="flex items-center gap-3">
                                        <span class="text-2xl">${medal}</span>
                                        <span class="text-xl font-bold text-gray-800">${s.label}</span>
                                    </div>
                                    <span class="text-2xl font-extrabold text-gray-800">${s.score}ç‚¹</span>
                                </div>
                            `;
                        }).join("")}
                    </div>
                `;

                if (myRole === "host") {
                    hostControls.innerHTML = `
                        <div class="flex flex-col sm:flex-row gap-3">
                            <button onclick="restartGame()" class="px-8 py-3 rounded-2xl bg-green-500 hover:bg-green-400 text-white font-bold shadow-lg transition">æ–°ã—ã„ã‚²ãƒ¼ãƒ ã‚’å§‹ã‚ã‚‹</button>
                            <button onclick="leaveGame()" class="px-8 py-3 rounded-2xl bg-gray-500 hover:bg-gray-400 text-white font-bold shadow-lg transition">å½¹å‰²é¸æŠã«æˆ»ã‚‹</button>
                        </div>
                    `;
                } else {
                    hostControls.innerHTML = `
                        <div class="flex flex-col items-center gap-4">
                            <p class="text-gray-600 font-medium">å‡ºé¡Œè€…ãŒæ–°ã—ã„ã‚²ãƒ¼ãƒ ã‚’é–‹å§‹ã™ã‚‹ã¾ã§ãŠå¾…ã¡ãã ã•ã„...</p>
                            <button onclick="leaveGame()" class="px-8 py-3 rounded-2xl bg-gray-500 hover:bg-gray-400 text-white font-bold shadow-lg transition">å½¹å‰²é¸æŠã«æˆ»ã‚‹</button>
                        </div>
                    `;
                }
                return; // çµæœç™ºè¡¨æ™‚ã¯ã“ã“ã§çµ‚äº†
            }

            // --- å…±é€šï¼šå›ç­”ã‚«ãƒ¼ãƒ‰ã®ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ ---
            const ids = ["player1", "player2", "player3"];
            const answers = data.answers || {};
            const answeredCount = Object.keys(answers).length;

            // 1. ãŠé¡Œã‚¨ãƒªã‚¢ã®è¡¨ç¤º
            if (!data.question) {
                const hostName = players.host || "å‡ºé¡Œè€…";
                if (myRole === "host") {
                    statusEl.innerText = "å‡ºé¡Œãƒ•ã‚§ãƒ¼ã‚ºï¼šå•é¡Œã‚’å…¥åŠ›ã—ã¦ãã ã•ã„";
                    questionBox.innerHTML = `
                        <div class="w-full max-w-2xl mx-auto space-y-3">
                            <textarea id="q-input" rows="1" oninput="autoResize(this)" class="w-full border-2 border-gray-300 bg-white rounded-xl px-4 py-3 text-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-amber-400 focus:border-amber-400 resize-none overflow-hidden" placeholder="ã“ã“ã«å•é¡Œæ–‡ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"></textarea>
                            <button onclick="sendQuestion()" class="w-full md:w-auto px-6 py-3 rounded-xl bg-amber-500 hover:bg-amber-400 text-white font-bold shadow-lg shadow-amber-500/40 transition">å‡ºé¡Œã™ã‚‹</button>
                        </div>
                    `;
                    requestAnimationFrame(() => window.autoResize(document.getElementById("q-input")));
                } else {
                    statusEl.innerText = `å‡ºé¡Œãƒ•ã‚§ãƒ¼ã‚ºï¼š${hostName}ã•ã‚“ãŒå•é¡Œã‚’å…¥åŠ›ã—ã¦ã„ã¾ã™`;
                    questionBox.innerHTML = `<div class="w-full space-y-2"><span class="text-xl md:text-2xl text-gray-600 block text-center font-bold">å•é¡Œã‚’è€ƒãˆã¦ã„ã¾ã™...</span></div>`;
                }
            } else {
                const hostName = players.host || "å‡ºé¡Œè€…";
                questionBox.innerHTML = `<div class="w-full space-y-3"><div class="text-sm md:text-base text-gray-600 text-center font-bold">å‡ºé¡Œè€…ï¼š${hostName}ã•ã‚“</div><span class="text-2xl md:text-3xl text-gray-800 block">${data.question}</span></div>`;
                statusEl.innerText = data.revealed ? "ã‚ªãƒ¼ãƒ—ãƒ³ãƒ•ã‚§ãƒ¼ã‚º" : `å›ç­”ãƒ•ã‚§ãƒ¼ã‚ºï¼š${answeredCount}/3äººãŒå›ç­”å®Œäº†`;
            }

            // 2. å›ç­”ã‚«ãƒ¼ãƒ‰ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
            ids.forEach((pid, idx) => {
                const label = players[pid] || `å›ç­”è€…${idx + 1}`;
                const score = points[pid] || 0;
                const isMe = myRole === pid;
                const ans = answers[pid];

                // ã‚¹ã‚³ã‚¢ãƒãƒƒã‚¸ï¼ˆåå‰ã®ä¸Šã«é…ç½®ï¼‰
                const scoreBadge = `
                    <div class="mb-1">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-bold bg-amber-100 text-amber-800 border border-amber-200">
                            ${score} ç‚¹
                        </span>
                    </div>`;

                let inner;
                if (!data.question) {
                    inner = `${scoreBadge}<div class="text-lg font-semibold text-gray-700">${label}</div><div class="text-sm text-gray-400 font-bold">ãŠé¡Œå¾…ã¡...</div>`;
                } else if (!data.revealed) {
                    // å›ç­”ä¸­
                    if (isMe) {
                        inner = `
                            ${scoreBadge}
                            <div class="text-lg font-semibold text-gray-700 mb-2">${label}</div>
                            <textarea id="a-input" rows="1" oninput="autoResize(this)" class="w-full border-2 border-gray-300 bg-white rounded-xl px-3 py-2 text-base text-gray-800 mb-2 resize-none overflow-hidden" placeholder="å›ç­”ã‚’å…¥åŠ›">${escapeHtml(ans || "")}</textarea>
                            
                            ${ans ? 
                                `<button onclick="sendAnswer()" class="w-full px-4 py-2 rounded-xl bg-emerald-500 hover:bg-emerald-400 text-white font-semibold shadow-md transition transform active:scale-95">å›ç­”ã‚’æ›´æ–°ã™ã‚‹</button>` : 
                                `<button onclick="sendAnswer()" class="w-full px-4 py-2 rounded-xl bg-sky-500 hover:bg-sky-400 text-white font-semibold shadow-lg shadow-sky-500/30 transition transform active:scale-95">å›ç­”ã‚’é€ä¿¡ã™ã‚‹</button>`
                            }
                        `;
                        requestAnimationFrame(() => window.autoResize(document.getElementById("a-input")));
                    } else {
                        inner = `${scoreBadge}<div class="text-lg font-semibold text-gray-700 mb-2">${label}</div><div class="${ans ? 'text-emerald-600' : 'text-gray-500'} font-bold text-xl">${ans ? 'OK' : 'å¾…æ©Ÿä¸­...'}</div>`;
                    }
                } else {
                    inner = `
                        ${scoreBadge}
                        <div class="text-lg font-semibold text-gray-700 mb-1">${label}</div>
                        <div class="flex-1 flex items-center justify-center py-2 px-2"><span class="text-xl text-gray-800 font-bold break-all leading-tight">${ans ?? "ï¼ˆç„¡å›ç­”ï¼‰"}</span></div>
                        ${myRole === "host" ? `<button onclick="addPoint('${pid}')" class="w-full px-4 py-2 rounded-xl bg-amber-500 text-white font-semibold shadow-md transition hover:scale-105">ãƒã‚¤ãƒ³ãƒˆ</button>` : ""}
                    `;
                }

                answersContainer.innerHTML += `
                    <div class="border-4 border-gray-300 rounded-2xl bg-gray-50 min-h-[160px] flex flex-col items-center justify-center p-4 text-center shadow-inner">
                        ${inner}
                    </div>
                `;
            });

            // 3. ãƒ›ã‚¹ãƒˆç”¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«
            if (myRole === "host" && data.question) {
                if (!data.revealed && answeredCount >= 3) {
                    hostControls.innerHTML = `<button onclick="reveal()" class="px-8 py-3 rounded-2xl bg-purple-500 hover:bg-purple-400 text-white font-bold text-lg shadow-lg transition transform hover:scale-105">å›ç­”ã‚’ã‚ªãƒ¼ãƒ—ãƒ³ã™ã‚‹ï¼</button>`;
                } else if (data.revealed) {
                    hostControls.innerHTML = `
                        <div class="flex flex-col sm:flex-row gap-3">
                            <button onclick="resetGame()" class="px-6 py-3 rounded-2xl bg-sky-500 hover:bg-sky-400 text-white font-bold transition shadow-lg">
                                æ¬¡ã®å•é¡Œã¸
                            </button>
                            <button onclick="endGame()" class="px-6 py-3 rounded-2xl bg-red-600 hover:bg-red-500 text-white font-bold transition shadow-lg">
                                å‡ºé¡Œçµ‚äº†
                            </button>
                        </div>
                    `;
                }
            }
        }

        // --- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³é–¢æ•° ---
        window.sendQuestion = () => {
            const q = document.getElementById('q-input').value;
            update(roomRef, { question: q, answers: {}, revealed: false });
        };

        window.sendAnswer = () => {
            const a = document.getElementById('a-input').value;
            update(ref(db, `game-room/answers`), { [myRole]: a });
        };

        window.reveal = () => update(roomRef, { revealed: true });

        window.addPoint = (id) => {
            const scoreRef = ref(db, `game-room/points/${id}`);
            onValue(scoreRef, (s) => {
                const current = s.val() || 0;
                set(scoreRef, current + 1);
            }, { onlyOnce: true });
        };

        window.resetGame = async () => {
            // ç›´å‰ã®ãƒã‚¤ãƒ³ãƒˆã‚’ä¿æŒã—ãŸã¾ã¾ã€å•é¡Œã¨å›ç­”ã ã‘ãƒªã‚»ãƒƒãƒˆã™ã‚‹
            const snap = await get(roomRef);
            const current = snap.val() || {};
            const points = current.points || {};
            await set(roomRef, { question: "", answers: {}, revealed: false, points, gameFinished: false });
        };

        window.endGame = async () => {
            // å‡ºé¡Œçµ‚äº†ã‚’è¨­å®šã—ã¦çµæœç™ºè¡¨ç”»é¢ã¸
            await update(roomRef, { gameFinished: true });
        };

        window.restartGame = async () => {
            // ã‚²ãƒ¼ãƒ ã‚’å®Œå…¨ã«ãƒªã‚»ãƒƒãƒˆã—ã¦æœ€åˆã‹ã‚‰å§‹ã‚ã‚‹ï¼ˆåå‰ã¨å½¹å‰²ã¯ä¿æŒï¼‰
            const snap = await get(roomRef);
            const current = snap.val() || {};
            const players = current.players || {};
            await set(roomRef, { question: "", answers: {}, revealed: false, points: {}, gameFinished: false, players });
        };

        window.leaveGame = async () => {
            // é€€å‡ºï¼šè‡ªåˆ†ã®åå‰ã¨å½¹å‰²ã‚’å‰Šé™¤ã—ã¦æœ€åˆã®ç”»é¢ã«æˆ»ã‚‹
            const playersRef = ref(db, `game-room/players`);
            const snap = await get(playersRef);
            const players = snap.val() || {};
            delete players[myRole];
            await update(playersRef, players);

            // çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
            myRole = "";
            myName = "";

            // ç”»é¢ã‚’æˆ»ã™
            document.getElementById("game").classList.add("hidden");
            document.getElementById("setup").classList.add("hidden");
            document.getElementById("name-input-screen").classList.remove("hidden");
            document.getElementById("name-input").value = "";
        };

    </script>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 flex items-center justify-center p-4">
    <div class="relative w-full max-w-5xl bg-white border-2 border-gray-200 rounded-2xl shadow-2xl shadow-gray-200/50 p-6 md:p-10 text-gray-800">
        <h1 class="text-3xl md:text-4xl font-extrabold tracking-wide mb-6 text-center bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent">
            ã‚ã‹ã‚Šã¦é¸æ‰‹æ¨©
        </h1>

        <!-- åå‰å…¥åŠ›ç”»é¢ -->
        <div id="name-input-screen" class="space-y-4 max-w-xl mx-auto">
            <p class="text-center text-gray-700 text-lg">ã‚ãªãŸã®åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼š</p>
            <div class="space-y-3">
                <input id="name-input" type="text" class="w-full border-2 border-gray-300 bg-white rounded-xl px-4 py-3 text-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400" placeholder="åå‰ã‚’å…¥åŠ›">
                <button onclick="submitName()" class="w-full py-3 px-4 rounded-xl bg-blue-500 hover:bg-blue-400 text-white font-semibold shadow-lg shadow-blue-500/40 transition">
                    æ±ºå®š
                </button>
            </div>
        </div>

        <!-- ã‚ãã³ã‹ãŸï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ï¼‰ -->
        <div id="howto-modal" class="hidden fixed inset-0 z-50 bg-black/40 flex items-center justify-center p-4" onclick="handleHowToBackdrop(event)">
            <div class="w-full max-w-2xl bg-white rounded-2xl border-2 border-gray-200 shadow-2xl shadow-gray-300/50 overflow-hidden">
                <div class="px-5 py-4 border-b border-gray-200 flex items-center justify-between">
                    <div class="text-lg md:text-xl font-bold text-gray-800">ã‚ãã³ã‹ãŸ</div>
                    <button onclick="closeHowTo()" class="px-3 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold transition">
                        é–‰ã˜ã‚‹
                    </button>
                </div>
                <div class="px-5 py-5 space-y-5 text-gray-800">
                    <div class="space-y-2">
                        <div class="font-bold">1. å‚åŠ </div>
                        <ul class="list-disc pl-5 text-gray-700 space-y-1">
                            <li>æœ€åˆã« <b>åå‰</b> ã‚’å…¥åŠ›ã—ã¦ã€Œæ±ºå®šã€</li>
                            <li>æ¬¡ã« <b>å‡ºé¡Œè€…</b> ã¾ãŸã¯ <b>å›ç­”è€…1ã€œ3</b> ã‚’é¸ã³ã¾ã™</li>
                        </ul>
                    </div>

                    <div class="space-y-2">
                        <div class="font-bold">2. ã‚²ãƒ¼ãƒ ã®æµã‚Œ</div>
                        <ul class="list-disc pl-5 text-gray-700 space-y-1">
                            <li><b>å‡ºé¡Œè€…</b> ãŒå•é¡Œã‚’å…¥åŠ›ã—ã¦ã€Œå‡ºé¡Œã™ã‚‹ã€</li>
                            <li><b>å›ç­”è€…</b> ã¯å›ç­”ã‚’å…¥åŠ›ã—ã¦é€ä¿¡ï¼ˆ<b>ã‚ªãƒ¼ãƒ—ãƒ³å‰ã¯ä½•åº¦ã§ã‚‚ä¿®æ­£å¯èƒ½</b>ï¼‰</li>
                            <li>å…¨å“¡ã®å›ç­”ãŒãã‚ã£ãŸã‚‰ã€å‡ºé¡Œè€…ãŒã€Œ<b>å›ç­”ã‚’ã‚ªãƒ¼ãƒ—ãƒ³ã™ã‚‹ï¼</b>ã€</li>
                            <li>å‡ºé¡Œè€…ãŒæ­£è§£è€…ã«ã€Œ<b>ãƒã‚¤ãƒ³ãƒˆ</b>ã€ã§å¾—ç‚¹ä»˜ä¸</li>
                            <li>ã€Œæ¬¡ã®å•é¡Œã¸ã€ã§ã‚¹ã‚³ã‚¢ã‚’æ®‹ã—ã¦æ¬¡ã®å•é¡Œã¸</li>
                        </ul>
                    </div>

                    <div class="space-y-2">
                        <div class="font-bold">3. å‡ºé¡Œçµ‚äº†ãƒ»çµæœç™ºè¡¨</div>
                        <ul class="list-disc pl-5 text-gray-700 space-y-1">
                            <li>å‡ºé¡Œè€…ãŒã€Œ<b>å‡ºé¡Œçµ‚äº†</b>ã€ã‚’æŠ¼ã™ã¨ <b>æœ€çµ‚çµæœ</b> ã‚’è¡¨ç¤ºã—ã¾ã™</li>
                            <li>çµæœç™ºè¡¨ç”»é¢ã§ã¯ã€Œ<b>é€€å‡ºã™ã‚‹</b>ã€ã§å½¹å‰²é¸æŠã‹ã‚‰ã‚„ã‚Šç›´ã›ã¾ã™</li>
                            <li>å‡ºé¡Œè€…ã¯ã€Œ<b>æ–°ã—ã„ã‚²ãƒ¼ãƒ ã‚’å§‹ã‚ã‚‹</b>ã€ã§ã‚¹ã‚³ã‚¢ã‚‚å«ã‚ã¦ãƒªã‚»ãƒƒãƒˆã§ãã¾ã™</li>
                        </ul>
                    </div>

                    <div class="text-xs text-gray-500">
                        ãƒ’ãƒ³ãƒˆï¼šè¤‡æ•°äººã§éŠã¶ã¨ãã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¿ãƒ–/åˆ¥ç«¯æœ«ã§ãã‚Œãã‚Œé–‹ã„ã¦å‚åŠ ã—ã¦ãã ã•ã„ã€‚
                    </div>
                </div>
            </div>
        </div>

        <div id="setup" class="hidden space-y-4 max-w-xl mx-auto">
            <p class="text-center text-gray-700">è‡ªåˆ†ã®å½¹å‰²ã‚’é¸ã‚“ã§ãã ã•ã„ï¼š</p>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                <button onclick="selectRole('host')" class="py-3 px-4 rounded-xl bg-amber-500 hover:bg-amber-400 text-white font-semibold shadow-lg shadow-amber-500/40 transition">
                    å‡ºé¡Œè€…
                </button>
                <button onclick="selectRole('player1')" class="py-3 px-4 rounded-xl bg-sky-500 hover:bg-sky-400 text-white font-semibold shadow-lg shadow-sky-500/40 transition">
                    å›ç­”è€…1
                </button>
                <button onclick="selectRole('player2')" class="py-3 px-4 rounded-xl bg-emerald-500 hover:bg-emerald-400 text-white font-semibold shadow-lg shadow-emerald-500/40 transition">
                    å›ç­”è€…2
                </button>
                <button onclick="selectRole('player3')" class="py-3 px-4 rounded-xl bg-violet-500 hover:bg-violet-400 text-white font-semibold shadow-lg shadow-violet-500/40 transition">
                    å›ç­”è€…3
                </button>
            </div>
        </div>

        <div id="game" class="hidden space-y-6 pb-16">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-2">
                <div id="scores" class="font-mono text-sm bg-gray-100 border-2 border-gray-300 rounded px-3 py-2 text-gray-800"></div>
                <div id="role-label" class="text-sm text-gray-600 font-semibold"></div>
            </div>

            <h2 id="status" class="text-lg md:text-xl font-semibold text-center text-gray-700">å¾…æ©Ÿä¸­...</h2>

            <!-- ãŠé¡Œã‚¨ãƒªã‚¢ -->
            <div id="question-box" class="border-4 border-gray-300 rounded-2xl bg-gradient-to-br from-yellow-50 to-amber-50 min-h-[120px] md:min-h-[140px] flex items-center justify-center px-4 py-6 text-2xl md:text-3xl font-bold tracking-wide text-center text-gray-800">
                ãŠé¡ŒãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™
            </div>

            <!-- å‡ºé¡Œè€…ç”¨ãƒœã‚¿ãƒ³ãªã© -->
            <div id="host-controls" class="flex flex-col md:flex-row gap-3 justify-center items-center"></div>

            <!-- å›ç­”ã‚¨ãƒªã‚¢ -->
            <div id="answers-container" class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-4">
                <!-- JS ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’å·®ã—è¾¼ã‚€ -->
            </div>
        </div>

        <!-- å…¨ç”»é¢å…±é€šï¼šã‚ãã³ã‹ãŸï¼ˆãƒ‘ãƒãƒ«å†… å³ä¸‹ï¼‰ -->
        <button onclick="openHowTo()"
            class="absolute bottom-4 right-4 md:bottom-6 md:right-6 z-40 px-4 py-2 rounded-full bg-white/90 hover:bg-white text-gray-800 font-semibold border-2 border-gray-300 shadow-lg shadow-gray-300/40 backdrop-blur transition">
            ã‚ãã³ã‹ãŸ
        </button>
    </div>
</body>
</html>